machine:
  java:
    version: oraclejdk8
  services:
    - docker
dependencies:
  pre:
    - ls
    - sed -i "s/^validation.token=.*/validation.token=$SAMPLE_TOKEN/g" ./src/main/resources/application.properties
    - sed -i "s/^app.secret=.*/app.secret=$SAMPLE_TOKEN/g" ./src/main/resources/application.properties
    - sed -i "s/^page.access.token=.*/age.access.token=$SAMPLE_TOKEN/g" ./src/main/resources/application.properties
    - cat $APPLICATION_PROPERTIES
  override:
    - mvn dependency:go-offline
test:
  override:
    - mvn integration-test
deployment:
  dev:
    branch: master
    commands: 
    - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
    - docker build -t hieupham/java-fb-chat .
    - docker push hieupham/java-fb-chat
